{% extends 'base.html.twig' %}

{% block title %}Dashboard Piluleo{% endblock %}

{% block stylesheets %}
    {{ parent() }}
    <link href="https://cdn.jsdelivr.net/npm/daisyui@3.1.0/dist/full.css" rel="stylesheet" type="text/css" />
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/remixicon@3.5.0/fonts/remixicon.css" rel="stylesheet">
{% endblock %}

{% block javascripts %}
    {{ parent() }}
    <script>
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    backgroundColor: {
                        dark: "black",
                    },
                },
            },
        };

        document.addEventListener("DOMContentLoaded", function () {
            const themeToggle = document.querySelector(".theme-controller");
            const htmlElement = document.documentElement;

            function applyTheme(isDark) {
                if (isDark) {
                    htmlElement.classList.add("dark");
                    htmlElement.setAttribute("data-theme", "black");
                    themeToggle.checked = true;
                } else {
                    htmlElement.classList.remove("dark");
                    htmlElement.setAttribute("data-theme", "light");
                    themeToggle.checked = false;
                }
            }

            const savedTheme = localStorage.getItem("theme");
            if (savedTheme) {
                applyTheme(savedTheme === "dark");
            }

            themeToggle.addEventListener("change", function () {
                const isDark = this.checked;
                applyTheme(isDark);
                localStorage.setItem("theme", isDark ? "dark" : "light");
            });
        });
    </script>
{% endblock %}

{% block body %}
<body class="bg-gray-100 dark:bg-gray-900 min-h-screen flex flex-col">

    <main class="flex-grow w-full px-4 sm:px-6 lg:px-8 py-8 bg-gray-100 dark:bg-black">
        <h1 class="text-3xl font-bold text-gray-900 dark:text-white mb-24 text-center">Dashboard de {{ user.prenom }} {{ user.nom }}</h1>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 max-w-7xl mx-auto">
            {% if isAdmin %}
                {% include 'components/card.html.twig' with {
                    'icon': 'ri-user-line',
                    'color': 'indigo-600',
                    'title': 'Administrateur',
                    'links': [
                        { 'path': path('app_utilisateur_index'), 'icon': 'ri-list-check', 'label': 'Liste utilisateurs' },
                        { 'path': path('app_register'), 'icon': 'ri-user-add-line', 'label': 'Creer nouvel utilisateur' }
                    ],
                    'hoverColor': 'indigo-800', 'darkColor': 'indigo-400', 'darkHoverColor': 'indigo-300'
                } %}
            {% endif %}

            {% if isAidant or isAdmin %}
                {% include 'components/card.html.twig' with {
                    'icon': 'ri-file-list-line', 'color': 'green-600', 'title': 'Gestion des ordonnances',
                    'links': [
                        { 'path': path('app_ordonnance_index'), 'icon': 'ri-file-list-3-line', 'label': 'Liste des ordonnances' },
                        { 'path': path('app_ordonnance_new'), 'icon': 'ri-file-add-line', 'label': 'Nouvelle ordonnance' }
                    ],
                    'hoverColor': 'green-800', 'darkColor': 'green-400', 'darkHoverColor': 'green-300'
                } %}

                {% include 'components/card.html.twig' with {
                    'icon': 'ri-group-line', 'color': 'blue-600', 'title': 'Gestion des patients',
                    'links': [
                        { 'path': path('app_patient_index'), 'icon': 'ri-team-line', 'label': 'Liste des Patients' },
                        { 'path': path('app_patient_new'), 'icon': 'ri-user-add-line', 'label': 'Nouveau patient' }
                    ],
                    'hoverColor': 'blue-800', 'darkColor': 'blue-400', 'darkHoverColor': 'blue-300'
                } %}

                {% include 'components/card.html.twig' with {
                    'icon': 'ri-capsule-line', 'color': 'red-600', 'title': 'Gestion des piluliers',
                    'links': [
                        { 'path': path('app_pilulier_index'), 'icon': 'ri-medicine-bottle-line', 'label': 'Liste des piluliers' },
                        { 'path': path('app_pilulier_new'), 'icon': 'ri-add-circle-line', 'label': 'Nouveau pilulier' }
                    ],
                    'hoverColor': 'red-800', 'darkColor': 'red-400', 'darkHoverColor': 'red-300'
                } %}
            {% endif %}

            {% if isPatient %}
                {% include 'components/card.html.twig' with {
                    'icon': 'ri-file-list-line', 'color': 'green-600', 'title': 'Mes ordonnances',
                    'links': [
                        { 'path': path('app_ordonnance_index'), 'icon': 'ri-file-list-3-line', 'label': 'Voir mes ordonnances' }
                    ],
                    'hoverColor': 'green-800', 'darkColor': 'green-400', 'darkHoverColor': 'green-300'
                } %}
            {% endif %}
        </div>

        <div class="mt-12 text-center">
            {% if isAdmin %}
                <p class="text-lg text-gray-700 dark:text-gray-300 mb-4">Vous êtes connecté en tant qu'administrateur</p>
            {% elseif isAidant %}
                <p class="text-lg text-gray-700 dark:text-gray-300 mb-4">Vous êtes connecté en tant qu'aidant</p>
            {% elseif isPatient %}
                <p class="text-lg text-gray-700 dark:text-gray-300 mb-4">Vous êtes connecté en tant que patient</p>
            {% endif %}
            <a href="{{ path('app_logout') }}" class="bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded transition duration-300 ease-in-out">
                Déconnexion
            </a>
        </div>
    </main>
</body>
{% endblock %}